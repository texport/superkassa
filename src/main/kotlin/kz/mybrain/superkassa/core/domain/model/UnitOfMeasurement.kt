package kz.mybrain.superkassa.core.domain.model

/**
 * Справочник единиц измерения для фискальных документов (ОКЕИ, РК).
 * Используется для поля measure_unit_code в позициях чека (протокол ОФД с версии 201).
 */
enum class UnitOfMeasurement(
    val code: String,
    val nameRus: String,
    val nameKaz: String,
    val shortRus: String,
    val shortKaz: String
) {
    PIECE("796", "Штука", "Дана", "шт", "дана"),
    KILOGRAM("116", "Килограмм", "Килограмм", "кг", "кг"),
    SERVICE("5114", "Услуга", "Қызмет", "усл", "қзм"),
    METER("006", "Метр", "Метр", "м", "м"),
    LITER("112", "Литр", "Литр", "л", "л"),
    LINEAR_METER("021", "Погонный метр", "Өткел қума метр", "пог.м", "өқм"),
    TON("168", "Тонна", "Тонна", "т", "т"),
    HOUR("356", "Час", "Сағат", "ч", "сағ"),
    DAY("359", "Сутки", "Тәулік", "с", "тлк"),
    WEEK("360", "Неделя", "Апта", "нед", "апт"),
    MONTH("362", "Месяц", "Ай", "мес", "ай"),
    MILLIMETER("003", "Миллиметр", "Миллиметр", "мм", "мм"),
    CENTIMETER("004", "Сантиметр", "Сантиметр", "см", "см"),
    DECIMETER("005", "Дециметр", "Дециметр", "дм", "дм"),
    UNIT("642", "Единица", "Бірлік", "ед", "брл"),
    KILOMETER("008", "Километр", "Километр", "км", "км"),
    HECTOGRAM("160", "Гектограмм", "Гектограмм", "гг", "гг"),
    MILLIGRAM("161", "Миллиграмм", "Миллиграмм", "мг", "мг"),
    METRIC_CARAT("162", "Метрический карат", "Метрлік карат", "мкар", "мкар"),
    GRAM("163", "Грамм", "Грамм", "гр", "гр"),
    MICROGRAM("164", "Микрограмм", "Микрограмм", "мкг", "мкг"),
    CUBIC_MILLIMETER("110", "Кубический миллиметр", "Куб миллиметр", "мм3", "мм3"),
    MILLILITER("111", "Миллилитр", "Миллилитр", "мл", "мл"),
    SQUARE_METER("055", "Квадратный метр", "Шаршы метр", "м2", "м2"),
    HECTARE("059", "Гектар", "Гектар", "га", "га"),
    SQUARE_KILOMETER("061", "Квадратный километр", "Шаршы километр", "км2", "км2"),
    SHEET("625", "Лист", "Парақ", "лист", "прқ"),
    PACK("728", "Пачка", "Бума", "пач", "бм"),
    ROLL("736", "Рулон", "Орам", "рул", "орам"),
    PACKAGE("778", "Упаковка", "Орама", "упак", "орм"),
    BOTTLE("868", "Бутылка", "Бөтелке", "бут", "бөт"),
    WORK("931", "Работа", "Жұмыс", "раб", "жұм"),
    CUBIC_METER("113", "Метр кубический", "Куб метр", "м3", "м3"),
    UNKNOWN("000", "Неизвестно", "Белгісіз", "?", "?");

    companion object {
        /**
         * Разрешает единицу измерения только по коду ОКЕИ.
         * @throws IllegalArgumentException если код не найден в справочнике.
         */
        fun fromCode(code: String): UnitOfMeasurement {
            val normalized = code.trim()
            if (normalized.isEmpty()) return DEFAULT
            return entries.find { it.code == normalized }
                ?: throw IllegalArgumentException("Unknown measure unit code: $normalized")
        }

        /** Код единицы по умолчанию (штука) для позиций, где не указано. */
        val DEFAULT = PIECE
    }
}
